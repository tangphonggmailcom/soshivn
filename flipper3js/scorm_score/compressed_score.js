/*! flipper-scorm-score */
this.flipperjs=this.flipperjs||{},function(a){var b=function(){this.thisName="ScoreController"},c=b.prototype;c._gaeConnect,c._initializedFlg=!1,c._scormVersion,c._lastPageNo=0,c._suspendData="",c._launch_data="",c._settingData,c._pcid="",c._PCID_KEY="LW_THiNQ_pcId",c._localStorageCtrl,c._sendFlg=!1,c.getSendFlg=function(){return this._sendFlg},c.init=function(a,b){this._settingData=b,this._localStorageCtrl=new flipperjs.LocalStorageController,this._localStorageCtrl.init(this._settingData.contentUrl,this._settingData.userInfo),this._pcid=this._localStorageCtrl.getData(this._PCID_KEY),this._init()},c._init=function(){this._gaeConnect=new flipperjs.GaeConnection(this._settingData.gaeUrl,this._settingData.gaeUrl_pcId,this._settingData.managerId,this._settingData.contentId,this._settingData.contentUrl),this._gaeConnect.setUserInfo(this._settingData.userInfo),this._gaeConnect.setContentName(this._settingData.contentTitle),this._gaeConnect.onGetPcId=jQuery.proxy(this._onGetPcId,this),this._gaeConnect.onCompletedSendPost=jQuery.proxy(this._onCompletedSendPost,this),this._gaeConnect.init(this._pcid),this._onInitializedScore()},c._onGetPcId=function(a){this._pcid=a,this._localStorageCtrl.setData(this._PCID_KEY,a)},c._onInitializedScore=function(){this._lastPageNo=this._localStorageCtrl.getDataForContentUser("lesson_location"),this._suspendData=this._localStorageCtrl.getDataForContentUser("suspend_data");var a=this._localStorageCtrl.getDataForContentUser("send_flg");"true"==a||1==a?this._sendFlg=!0:this._sendFlg=!1,this.onInitialized(this._lastPageNo,this._suspendData,this._launch_data),this._initializedFlg=!0},c.onInitialized=function(a,b,c){},c.getInitializedFlg=function(){return this._initializedFlg},c.sendData=function(a){var b=new Object;b.status=a,this._gaeConnect.sendContentData(b)},c.setValue=function(a,b){switch(a){case"lesson_location":case"suspend_data":this._localStorageCtrl.setDataForContentUser(a,b)}},c.getValue=function(a){return""},c.commit=function(){},c._onCompletedSendPost=function(a){a.result+"/"+a.message;this.onCompletedSendPost(a),this._sendFlg=a.result,this._localStorageCtrl.setDataForContentUser("send_flg",this._sendFlg)},c.onCompletedSendPost=function(a){},flipperjs.ScoreController=b}(window),function(a){window.XDomainRequest&&a.ajaxTransport(function(b){if(b.crossDomain&&b.async){b.timeout&&(b.xdrTimeout=b.timeout,delete b.timeout);var c;return{send:function(d,e){function f(b,d,f,g){c.onload=c.onerror=c.ontimeout=c.onprogress=a.noop,c=void 0,e(b,d,f,g)}c=new XDomainRequest,c.open(b.type,b.url),c.onload=function(){f(200,"OK",{text:c.responseText},"Content-Type: "+c.contentType)},c.onerror=function(){f(404,"Not Found")},c.onprogress=function(){},b.xdrTimeout&&(c.ontimeout=function(){f(0,"timeout")},c.timeout=b.xdrTimeout),c.send(b.hasContent&&b.data||null)},abort:function(){c&&(c.onerror=a.noop(),c.abort())}}}})}(jQuery),this.flipperjs=this.flipperjs||{},function(a){var b=function(a,b,c,d,e){this.thisName="GaeConnection",this._sendToDomain=a,this._sendToDomainForPcID=b,this._managerID=c,this._contentID=d,this._contentUrl=e,"https:"==location.protocol&&(this._sendToDomain=this._sendToDomain.replace("http://","https://"),this._sendToDomainForPcID=this._sendToDomainForPcID.replace("http://","https://"))},c=b.prototype;c._sendToDomain="",c._sendToDomainForPcID="",c._managerID="",c._contentID="",c._contentUrl="",c._sessionID=String((new Date).getTime()),c._interactionList=new Array,c._userInfo="",c._pcID="",c._contentName="",c.GAE_SAVE_DATA="/lwloginsert",c.GAE_GET_PCID="/lwGetPcIdForMobile",c._productID="FLIPPER",c.init=function(a){""==a?this._sendContentOpen():this._pcID=a},c.setUserInfo=function(a){this._userInfo=a},c.setPcId=function(a){this._pcID=a},c.setContentName=function(a){this._contentName=a},c.sendContentData=function(a){var b=new Object;b.action="end",b.value=this._createObjDataString(a),b.detailValue=this._interactionList.join("[QS]"),b=this._createDataObj(b),this._sendPostData(this._sendToDomain+this.GAE_SAVE_DATA,b)},c.sendInteractionData=function(a){var b=this._createObjDataString(a);this._interactionList.push(b)},c._createObjDataString=function(a){var b="";for(var c in a)""!=b&&(b+="[PS]"),b+=c+"[LS]"+a[c];return b},c._createDataObj=function(a){var b=new Object;for(var c in a)b[c]=a[c];return b.type=this._productID,b.manager_id=this._managerID,b.content_id=this._contentID,b.content_url=this._contentUrl,b.content_name=this._contentName,b.session_id=this._sessionID,b.user=this._userInfo,b.pc_id=this._pcID,b},c._sendContentOpen=function(){var a=new Object;a.action="start",a=this._createDataObj(a),this._dataSendGet(this._sendToDomainForPcID+this.GAE_GET_PCID,a)},c._sendPostData=function(a,b){try{_onCompletedSendPostFromAS3=jQuery.proxy(this._onCompletedSendPostFromAS3,this),fromJStoAS3_sendPost(a,b)}catch(c){this._dataSendPost(a,b)}},c._onCompletedSendPostFromAS3=function(a){this._onCompletedSendPost(a)},$.extend({xpost:function(a,b,c){var d="dummyxpostframe",e=function(){$("form[target="+d+"]").remove(),$("iframe[name="+d+"]").remove()},f=$("<iframe />").attr("name",d).hide().appendTo("body");"function"==typeof c&&f.load(c),f.load(e),$form=$('<form method="POST" />').attr("action",a).attr("target",d);for(key in b){var g=document.createElement("input");g.setAttribute("type","hidden"),g.setAttribute("name",key),g.setAttribute("value",b[key]),$form.append($(g))}$form.hide().appendTo("body").submit()}}),c._dataSendGet=function(a,b){a+="?callback=?";var c=this;$.getJSON(a,b,function(a){c._onGetPcId(a)})},c._onGetPcId=function(a){this._pcID=a.pcId,this.onGetPcId(this._pcID)},c.onGetPcId=function(a){},c._dataSendPost=function(a,b){try{var c=this;$.ajax({type:"post",dataType:"text",data:b,url:a,crossDomain:!0,success:function(a){c._onCompletedSendPostForMobile(a)},error:function(a,b,d){c._onCompletedSendPostForMobile(b)}})}catch(d){}},c._onCompletedSendPostForMobile=function(a){var b={};try{var c=a.split("&");for(var d in c){var e=c[d],f=e.split("=");2==f.length&&(b[f[0]]=f[1])}}catch(g){}this._onCompletedSendPost(b)},c._onCompletedSendPost=function(a){a&&a.hasOwnProperty("result")||(a=new Object,a.result=!1,a.message="Network Error"),this.onCompletedSendPost(a)},c.onCompletedSendPost=function(a){},flipperjs.GaeConnection=b}(window),this.flipperjs=this.flipperjs||{},function(a){var b=function(){this.thisName="LocalStorageController"},c=b.prototype;c._localStorageFlg=!1,c._cookieVarObj={},c._localStorageObjForContentUser={},c._localStorageObjForContentUserKey="",c._userInfo="",c.init=function(a,b){if(this._userInfo=b,this._localStorageFlg=this._checkLocalStorage(),this._localStorageFlg)try{this._localStorageObjForContentUserKey=encodeURI(a+"_"+b);var c=localStorage.getItem(this._localStorageObjForContentUserKey);null!=c&&""!=c&&void 0!=c&&(this._localStorageObjForContentUser=JSON.parse(c))}catch(d){}else{this._cookieVarObj=this._getGetCookies();var e="";for(key in this._cookieVarObj)e+="_cookieVarObj["+key+"]:"+this._cookieVarObj[key]+"/"}},c.getData=function(a){var b="";return this._localStorageFlg?b=localStorage.getItem(a):null!=this._cookieVarObj&&this._cookieVarObj.hasOwnProperty(a)&&(b=this._cookieVarObj[a]),(null==b||void 0==b)&&(b=""),b},c.setData=function(a,b){if(this._localStorageFlg)localStorage.setItem(a,b);else{var c=new Date;c.setYear(c.getFullYear()+1);var d=a+"="+encodeURIComponent(b)+";path=/;expires="+c.toUTCString();document.cookie=d}},c.getDataForContentUser=function(a){var b="";if(this._localStorageFlg)try{null!=this._localStorageObjForContentUser&&this._localStorageObjForContentUser.hasOwnProperty(a)&&(b=this._localStorageObjForContentUser[a])}catch(c){}else{var d=a;null!=this._cookieVarObj&&this._cookieVarObj.hasOwnProperty(d)&&(b=this._cookieVarObj[d])}return(null==b||void 0==b)&&(b=""),b},c.setDataForContentUser=function(a,b){if(this._localStorageFlg)try{this._localStorageObjForContentUser[a]=b;var c=JSON.stringify(this._localStorageObjForContentUser);localStorage.setItem(this._localStorageObjForContentUserKey,c)}catch(d){}else{var e=a,f=new Date;f.setYear(f.getFullYear()+1);var g=e+"="+encodeURIComponent(b)+";expires="+f.toUTCString();document.cookie=g}},c._getGetCookies=function(){var a=new Object,b=document.cookie;if(""!=b)for(var c=b.split(";"),d=0;d<c.length;d++){var e=c[d].replace(/^\s+|\s+$/g,""),f=e.split("=");a[f[0]]=decodeURIComponent(f[1])}return a},c._checkLocalStorage=function(){var b=!1;try{if("localStorage"in a&&null!==a.localStorage){localStorage.setItem("test","test");var c=localStorage.getItem("test");b=c?!0:!1}}catch(d){b=!1}return b},flipperjs.LocalStorageController=b}(window);